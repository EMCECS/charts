---
{{- if .Values.createDeosObjectStoreApp}}
apiVersion: app.k8s.io/v1beta1
kind: Application
metadata:
  name: {{.Release.Name}}
  namespace: {{.Release.Namespace}}
  labels:
    app.kubernetes.io/name: {{.Release.Name}}
    app.kubernetes.io/version: {{.Values.tag}}
    app.kubernetes.io/instance: {{.Release.Name}}
    app.kubernetes.io/managed-by: {{.Release.Service}}
    helm.sh/chart: {{.Chart.Name}}-{{.Chart.Version | replace "+" "_"}}
    product: "objetscale"
    release: {{.Release.Name}}
  annotations:
    com.dellemc.kahm.subscribed: "true"
spec:
  selector:
    matchLabels:
      app.kubernetes.io/name: {{.Release.Name}}
  componentKinds:
    - group: core
      kind: ConfigMaps
    - group: core
      kind: Secrets
      ## do we need to enumerate all the other components such as
      ## ReplicaSets, StatefulSets, PVCs etc...
      # eventually this will be objectstores
    - group: ecsclusters.ecs.dellemc.com
      kind: ECSCluster   # aka objectstore here too
  assemblyPhase: "Pending"
  descriptor:
    type: objectstore
    version: {{.Values.tag}}
    description: >
      Dell EMC ObjectScale Object Store
    keywords:
      - "deos"
      - "objectscale"
      - "object store"
      - "flex"
      - "ecs"
      - "s3"
    info:
      - "Copyright Â© 2019-2020 Dell Inc. or its subsidiaries. All Rights Reserved."
{{- end}}
