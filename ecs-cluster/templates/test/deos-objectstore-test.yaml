---
apiVersion: v1
kind: Pod
metadata:
  name: {{ .Release.Name }}-deos-hc
  labels:
    release: {{ .Release.Name }}
  namespace: {{ .Release.Namespace }}
spec:
  containers:
  - image: 
      repository: {{ .Values.global.registry }}/{{ .Values.deos-hc.image.repository }}
{{- if .Values.deos-hc.image.tag }}
      tag: {{ .Values.deos-hc.image.tag }}
{{- else }}
      tag: {{ .Values.tag }}
{{- end }}
{{- if .Values.deos-hc.image.pullPolicy }}
      pullPolicy: {{ .Values.deos-hc.image.pullPolicy }}
{{- else }}
      pullPolicy: {{ .Values.pullPolicy }}
{{- end }}
    command:
    - /deos-hc all
    name: hc-container
    env:
    - name: SECRET_USERNAME
      valueFrom:
        secretKeyRef:
          name: mgmtapi-login-info-secret
          key: username
    - name: SECRET_PASSWORD
      valueFrom:
        secretKeyRef:
          name: mgmtapi-login-info-secret
          key: password
    - name: POD_NAMESPACE
      value: {{ .Release.Namespace }}
    - name: RELEASE_NAME
      value: {{ .Release.Name }}
  restartPolicy: Never