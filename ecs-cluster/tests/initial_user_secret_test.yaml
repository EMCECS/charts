suite: test ecs-cluster resource
templates:
  - initial_user_secret.yaml
tests:
  - it: should create a kubernetes secret
    asserts:
      - isKind:
          of: Secret
  - it: should have a resource name
    asserts:
    - equal:
        path: metadata.name
        value: RELEASE-NAME-initial-user
  - it: should have a namespace
    asserts:
    - equal:
        path: metadata.namespace
        value: NAMESPACE
  - it: MUST have annotations
    asserts:
    - equal:
        path: metadata.annotations
        value:
          helm.sh/hook: pre-install
          helm.sh/hook-delete-policy: before-hook-creation
  - it: should have labels
    asserts:
    - equal:
        path: metadata.labels
        value:
          release: RELEASE-NAME
  - it: should have values for the keys
    asserts:
    - isNotEmpty:
        path: stringData.accessKey
        path: stringData.managementKey
        path: stringData.secretKey
