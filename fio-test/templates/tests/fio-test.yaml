---
apiVersion: v1
kind: Pod
metadata:
  name: {{ .Release.Name }}
  labels:
    release: {{ .Release.Name }}
  namespace: {{ .Release.Namespace}}
  annotations:
    "helm.sh/hook": test-success
spec:
    containers:
      - name: {{ .Release.Name }}
        image: kimixu/alpine-fio:v0.1
        imagePullPolicy: Always
        volumeMounts:
          - name: {{ .Release.Name }}
            mountPath: /data
          - name: {{ .Release.Name }}-fio-config-volume
            mountPath: /etc/config
        command: ["/bin/sh", "-c"]
        args: ["/usr/local/bin/fio /etc/config/default-config.fio
              --output-format=json
              --output=/data/fio.out;"]
    volumes:
      - name: {{ .Release.Name }}
        hostPath:
            path: /data/FIO
      - name: {{ .Release.Name }}-fio-config-volume
        configMap:
          name: {{ .Release.Name }}-fio-config
    restartPolicy: Never
---


apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-dummy-config
  namespace: {{ .Release.Namespace}}
data:
  special.func: dummy