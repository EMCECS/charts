{{- define "rest-credentials" -}}
{{- $user := randAlphaNum 16 | default .Values.rest.username -}}
{{- $password := randAlphaNum 16 | default .Values.rest.password -}}
{{- printf "objectscale:%s:%s" $user $password | b64enc }}
{{- end -}}
---
apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-rest-credentials
type: Opaque
data:
  credentials: {{ template "rest-credentials" }}