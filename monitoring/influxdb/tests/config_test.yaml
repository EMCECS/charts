#
# Copyright Â© [2020] Dell Inc. or its subsidiaries.
# All Rights Reserved.
#
# This software contains the intellectual property of Dell Inc.
# or is licensed to Dell Inc. from third parties. Use of this
# software and the intellectual property contained therein is expressly
# limited to the terms and conditions of the License Agreement under which
# it is provided by or on behalf of Dell Inc. or its subsidiaries.
#
#

suite: test config
templates:
  - config.yaml
tests:
  - it: 3 influxdb replicas
    set:
      global.influxdb_replicas: 3
    asserts:
      - matchRegex:
          path: data.endpoints\.json
          pattern: '"id": "RELEASE-NAME-influxdb-0"'
          pattern: '"ip": "127.0.0.11"'
          pattern: '"http_port": "8186"'
          pattern: '"rpc_port": "8188"'
          pattern: '"id": "RELEASE-NAME-influxdb-1"'
          pattern: '"ip": "127.0.0.12"'
          pattern: '"http_port": "8286"'
          pattern: '"rpc_port": "8288"'
          pattern: '"id": "RELEASE-NAME-influxdb-2"'
          pattern: '"ip": "127.0.0.13"'
          pattern: '"http_port": "8386"'
          pattern: '"rpc_port": "8388"'

# [
#   {
#     "id": "RELEASE-NAME-influxdb-0",
#     "ip": "127.0.0.11",
#     "http_port": "8186",
#     "rpc_port": "8188"
#   },
#   {
#     "id": "RELEASE-NAME-influxdb-1",
#     "ip": "127.0.0.12",
#     "http_port": "8286",
#     "rpc_port": "8288"
#   },
#   {
#     "id": "RELEASE-NAME-influxdb-2",
#     "ip": "127.0.0.13",
#     "http_port": "8386",
#     "rpc_port": "8388"
#   }
# ]

