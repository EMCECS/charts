#
# Copyright Â© [2020] Dell Inc. or its subsidiaries.
# All Rights Reserved.
#
# This software contains the intellectual property of Dell Inc.
# or is licensed to Dell Inc. from third parties. Use of this
# software and the intellectual property contained therein is expressly
# limited to the terms and conditions of the License Agreement under which
# it is provided by or on behalf of Dell Inc. or its subsidiaries.
#
#

suite: test profile
templates:
  - statefulset.yaml
tests:
  - it: Micro
    set:
      global.performanceProfile: "Micro"
    asserts:
      - equal:
          path: spec.template.spec.containers[0].resources.requests
          value:
            memory: 410Mi
            ephemeral-storage: 410Mi
      - equal:
          path: spec.template.spec.initContainers[0].resources.requests
          value:
            memory: 300Mi
            ephemeral-storage: 300Mi
  - it: Small
    set:
      global.performanceProfile: "Small"
    asserts:
      - equal:
          path: spec.template.spec.containers[0].resources.requests
          value:
            memory: 410Mi
            ephemeral-storage: 410Mi
      - equal:
          path: spec.template.spec.initContainers[0].resources.requests
          value:
            memory: 300Mi
            ephemeral-storage: 300Mi
  - it: Medium
    set:
      global.performanceProfile: "Medium"
    asserts:
      - equal:
          path: spec.template.spec.containers[0].resources.requests
          value:
            memory: 1134Mi
            ephemeral-storage: 1134Mi
      - equal:
          path: spec.template.spec.initContainers[0].resources.requests
          value:
            memory: 1Gi
            ephemeral-storage: 1Gi
  - it: Large
    set:
      global.performanceProfile: "Large"
    asserts:
      - equal:
          path: spec.template.spec.containers[0].resources.requests
          value:
            memory: 2154Mi
            ephemeral-storage: 2154Mi
      - equal:
          path: spec.template.spec.initContainers[0].resources.requests
          value:
            memory: 2Gi
            ephemeral-storage: 2Gi
