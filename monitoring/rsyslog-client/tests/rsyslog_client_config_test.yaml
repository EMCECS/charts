#
# Copyright Â© [2020] Dell Inc. or its subsidiaries.
# All Rights Reserved.
#
# This software contains the intellectual property of Dell Inc.
# or is licensed to Dell Inc. from third parties. Use of this
# software and the intellectual property contained therein is expressly
# limited to the terms and conditions of the License Agreement under which
# it is provided by or on behalf of Dell Inc. or its subsidiaries.
#
#

suite: test rsyslog client config
templates:
  - rsyslog-client-config.yaml
tests:
  - it: use objectscale rsyslog
    set:
      global.use_objectscale_rsyslog: true
      global.objectscale_release_name: objectscale-release
      global.objectscale_namespace: objectscale-ns
    asserts:
      - matchRegex:
          path: data.rsyslog\.conf
          pattern: Target="_RSYSLOG_POD_NAME_.objectscale-release-rsyslog.objectscale-ns.svc.cluster.local"
  - it: use local rsyslog
    set:
      global.use_objectscale_rsyslog: false
    asserts:
      - matchRegex:
          path: data.rsyslog\.conf
          pattern: Target="_RSYSLOG_POD_NAME_.RELEASE-NAME-rsyslog.NAMESPACE.svc.cluster.local"
